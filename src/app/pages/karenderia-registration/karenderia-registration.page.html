<ion-content class="ion-padding">
  <div class="form-container">
    <h1 class="title">Create Account</h1>
    <p class="subtitle">Start your culinary journey with us</p>

    <form #registrationForm="ngForm" (ngSubmit)="onRegister(registrationForm)">
      <!-- Basic Info -->
      <div class="input-field">
        <ion-icon name="person-outline"></ion-icon>
        <ion-input
          [(ngModel)]="registerData.username"
          name="username"
          placeholder="Username"
          class="custom-input"
          required>
        </ion-input>
      </div>

      <div class="input-field">
        <ion-icon name="mail-outline"></ion-icon>
        <ion-input
          [(ngModel)]="registerData.email"
          name="email"
          type="email"
          placeholder="Email"
          class="custom-input"
          required>
        </ion-input>
      </div>

      <div class="input-field">
        <ion-icon name="business-outline"></ion-icon>
        <ion-select
          [(ngModel)]="registerData.role"
          name="role"
          placeholder="Account Type"
          class="custom-input"
          (ionChange)="onRoleChange($event)"
          required>
          <ion-select-option value="User">Regular User</ion-select-option>
          <ion-select-option value="Karenderia Owner">Karenderia Owner</ion-select-option>
        </ion-select>
      </div>

      <!-- Karenderia Owner Section -->
      <!-- TEMPORARY: Always show for testing -->
      <div style="border: 2px solid red; padding: 10px;">
        <p style="color: red;">DEBUG: Role value is: "{{ registerData.role }}"</p>
        <p style="color: blue;">Is equal to 'Karenderia Owner'? {{ registerData.role === 'Karenderia Owner' }}</p>
        
        <!-- Info Card -->
        <div class="info-card">
          <div class="card-header">
            <ion-icon name="storefront-outline"></ion-icon>
            <h2>Karenderia Owner</h2>
          </div>
          <p class="info-text">Submit your business for approval, manage your karenderia listing, and reach more customers.</p>
          <div class="warning-box">
            <ion-icon name="warning-outline"></ion-icon>
            <span>Business permit required for verification.</span>
          </div>
        </div>

        <!-- Business Name -->
        <div class="input-field" style="border: 1px solid blue; margin: 10px 0;">
          <ion-icon name="business-outline"></ion-icon>
          <ion-input
            [(ngModel)]="registerData.business_name"
            name="business_name"
            placeholder="Business Name"
            class="custom-input"
            required>
          </ion-input>
        </div>

        <!-- Description -->
        <div class="input-field" style="border: 1px solid green; margin: 10px 0;">
          <ion-icon name="document-text-outline"></ion-icon>
          <ion-textarea
            [(ngModel)]="registerData.description"
            name="description"
            placeholder="Description"
            class="custom-input"
            required>
          </ion-textarea>
        </div>

        <!-- Description -->
        <div class="input-field">
          <ion-icon name="document-text-outline"></ion-icon>
          <ion-textarea
            [(ngModel)]="registerData.description"
            name="description"
            placeholder="Description"
            class="custom-input"
            required>
          </ion-textarea>
        </div>

        <!-- Full Address -->
        <div class="input-field">
          <ion-icon name="location-outline"></ion-icon>
          <ion-input
            [(ngModel)]="registerData.address"
            name="address"
            placeholder="Full Address"
            class="custom-input"
            required>
          </ion-input>
        </div>

        <!-- City & Province -->
        <div class="address-row">
          <div class="input-field">
            <ion-icon name="map-outline"></ion-icon>
            <ion-input
              [(ngModel)]="registerData.city"
              name="city"
              placeholder="City"
              class="custom-input"
              required>
            </ion-input>
          </div>

          <div class="input-field">
            <ion-icon name="map-outline"></ion-icon>
            <ion-input
              [(ngModel)]="registerData.province"
              name="province"
              placeholder="Province"
              class="custom-input"
              required>
            </ion-input>
          </div>
        </div>

        <!-- Phone Number -->
        <div class="input-field">
          <ion-icon name="call-outline"></ion-icon>
          <ion-input
            [(ngModel)]="registerData.phone"
            name="phone"
            type="tel"
            placeholder="Phone Number"
            class="custom-input"
            required>
          </ion-input>
        </div>

        <!-- Business Email -->
        <div class="input-field">
          <ion-icon name="mail-outline"></ion-icon>
          <ion-input
            [(ngModel)]="registerData.business_email"
            name="business_email"
            type="email"
            placeholder="Business Email"
            class="custom-input"
            required>
          </ion-input>
        </div>

        <!-- Opening & Closing Time -->
        <div class="time-row">
          <div class="input-field">
            <ion-icon name="time-outline"></ion-icon>
            <ion-input
              [(ngModel)]="registerData.opening_time"
              name="opening_time"
              type="time"
              placeholder="Opening Time"
              class="custom-input"
              required>
            </ion-input>
          </div>

          <div class="input-field">
            <ion-icon name="time-outline"></ion-icon>
            <ion-input
              [(ngModel)]="registerData.closing_time"
              name="closing_time"
              type="time"
              placeholder="Closing Time"
              class="custom-input"
              required>
            </ion-input>
          </div>
        </div>

        <!-- Business Permit Upload -->
        <div class="permit-upload">
          <button type="button" class="upload-btn" (click)="uploadBusinessPermit()" *ngIf="!registerData.business_permit_file">
            <ion-icon name="cloud-upload-outline"></ion-icon>
            <span>Upload Business Permit</span>
          </button>
          <div class="file-preview" *ngIf="registerData.business_permit_file">
            <ion-icon name="document-outline"></ion-icon>
            <span>{{ registerData.business_permit_file.name }}</span>
            <ion-icon name="close-circle" (click)="removeBusinessPermit()"></ion-icon>
          </div>
        </div>
      </div>

      <!-- Password Fields -->
      <div class="input-field">
        <ion-icon name="lock-closed-outline"></ion-icon>
        <ion-input
          [(ngModel)]="registerData.password"
          name="password"
          type="password"
          placeholder="Password"
          class="custom-input"
          required>
        </ion-input>
      </div>

      <div class="input-field">
        <ion-icon name="lock-closed-outline"></ion-icon>
        <ion-input
          [(ngModel)]="registerData.confirmPassword"
          name="confirmPassword"
          type="password"
          placeholder="Confirm Password"
          class="custom-input"
          required>
        </ion-input>
      </div>

      <!-- Submit Button -->
      <ion-button expand="block" type="submit" class="submit-btn">
        CREATE ACCOUNT
      </ion-button>

      <!-- Login Link -->
      <div class="login-link">
        Already have an account? <a routerLink="/login">Sign in</a>
      </div>
    </form>
  </div>
</ion-content>