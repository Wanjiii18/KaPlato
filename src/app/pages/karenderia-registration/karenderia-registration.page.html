<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Register Your Karenderia</ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="registration-container">
    <div class="registration-header">
      <ion-icon name="restaurant-outline" class="header-icon"></ion-icon>
      <h2>Join KaPlato as a Restaurant Partner</h2>
      <p>Fill out the form below to register your karenderia. Admin approval is required before your restaurant appears to customers.</p>
    </div>

    <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
      <!-- Basic Information -->
      <div class="form-section">
        <h3><ion-icon name="information-circle-outline"></ion-icon> Basic Information</h3>
        
        <ion-item>
          <ion-input 
            formControlName="name"
            label="Restaurant Name *"
            labelPlacement="stacked"
            placeholder="Enter your karenderia name"
            [class.error]="registrationForm.get('name')?.invalid && registrationForm.get('name')?.touched">
          </ion-input>
        </ion-item>
        
        <ion-item>
          <ion-textarea 
            formControlName="description"
            label="Description *"
            labelPlacement="stacked"
            placeholder="Describe your restaurant and specialties"
            rows="4"
            [class.error]="registrationForm.get('description')?.invalid && registrationForm.get('description')?.touched">
          </ion-textarea>
        </ion-item>
      </div>

      <!-- Contact Information -->
      <div class="form-section">
        <h3><ion-icon name="call-outline"></ion-icon> Contact Information</h3>
        
        <ion-item>
          <ion-input 
            formControlName="phone"
            label="Phone Number"
            labelPlacement="stacked"
            placeholder="+63 9XX XXX XXXX"
            type="tel">
          </ion-input>
        </ion-item>
        
        <ion-item>
          <ion-input 
            formControlName="email"
            label="Email Address"
            labelPlacement="stacked"
            placeholder="restaurant@example.com"
            type="email">
          </ion-input>
        </ion-item>
      </div>

      <!-- Location Information -->
      <div class="form-section">
        <h3><ion-icon name="location-outline"></ion-icon> Location & Address</h3>
        
        <ion-item>
          <ion-textarea 
            formControlName="address"
            label="Full Address *"
            labelPlacement="stacked"
            placeholder="Complete address with landmarks"
            rows="3"
            [class.error]="registrationForm.get('address')?.invalid && registrationForm.get('address')?.touched">
          </ion-textarea>
        </ion-item>

        <!-- Map Location Selector -->
        <div class="map-section">
          <div class="map-header">
            <h4>Set Your Location on Map *</h4>
            <p>Drag the marker to your exact restaurant location</p>
          </div>
          
          <div class="map-container" #mapContainer>
            <!-- Google Maps will be rendered here -->
          </div>
          
          <div class="coordinates-display" *ngIf="selectedLocation.lat && selectedLocation.lng">
            <ion-chip color="success">
              <ion-icon name="location"></ion-icon>
              <ion-label>Location Selected: {{selectedLocation.lat | number:'1.6-6'}}, {{selectedLocation.lng | number:'1.6-6'}}</ion-label>
            </ion-chip>
          </div>
          
          <ion-button 
            fill="outline" 
            size="small" 
            (click)="getCurrentLocation()"
            [disabled]="isGettingLocation">
            <ion-icon name="locate" slot="start"></ion-icon>
            {{isGettingLocation ? 'Getting Location...' : 'Use Current Location'}}
          </ion-button>
        </div>
      </div>

      <!-- Operating Hours -->
      <div class="form-section">
        <h3><ion-icon name="time-outline"></ion-icon> Operating Hours</h3>
        
        <div class="operating-hours">
          <ion-item>
            <ion-input 
              formControlName="opening_time"
              label="Opening Time"
              labelPlacement="stacked"
              type="time">
            </ion-input>
          </ion-item>
          
          <ion-item>
            <ion-input 
              formControlName="closing_time"
              label="Closing Time"
              labelPlacement="stacked"
              type="time">
            </ion-input>
          </ion-item>
        </div>

        <div class="operating-days">
          <h4>Operating Days</h4>
          <div class="days-grid">
            <ion-checkbox 
              *ngFor="let day of weekDays" 
              [checked]="selectedDays.includes(day.value)"
              (ionChange)="toggleDay(day.value)">
              {{day.label}}
            </ion-checkbox>
          </div>
        </div>
      </div>

      <!-- Delivery Information -->
      <div class="form-section">
        <h3><ion-icon name="bicycle-outline"></ion-icon> Delivery Information</h3>
        
        <ion-item>
          <ion-input 
            formControlName="delivery_fee"
            label="Delivery Fee (â‚±)"
            labelPlacement="stacked"
            placeholder="25"
            type="number"
            min="0">
          </ion-input>
        </ion-item>
        
        <ion-item>
          <ion-input 
            formControlName="delivery_time_minutes"
            label="Estimated Delivery Time (minutes)"
            labelPlacement="stacked"
            placeholder="30"
            type="number"
            min="0">
          </ion-input>
        </ion-item>
      </div>

      <!-- Payment Methods -->
      <div class="form-section">
        <h3><ion-icon name="card-outline"></ion-icon> Payment Methods</h3>
        
        <ion-item>
          <ion-checkbox formControlName="accepts_cash"></ion-checkbox>
          <ion-label class="payment-label">Accept Cash on Delivery</ion-label>
        </ion-item>
        
        <ion-item>
          <ion-checkbox formControlName="accepts_online_payment"></ion-checkbox>
          <ion-label class="payment-label">Accept Online Payment</ion-label>
        </ion-item>
      </div>

      <!-- Submit Button -->
      <div class="submit-section">
        <ion-button 
          expand="block" 
          type="submit" 
          [disabled]="!registrationForm.valid || isSubmitting || !selectedLocation.lat">
          <ion-icon name="send" slot="start"></ion-icon>
          {{isSubmitting ? 'Submitting...' : 'Submit Application'}}
        </ion-button>
        
        <div class="form-note">
          <ion-text color="medium">
            <p><ion-icon name="information-circle"></ion-icon> 
            Your application will be reviewed by our admin team. You'll be notified once approved.</p>
          </ion-text>
        </div>
      </div>
    </form>
  </div>
</ion-content>
