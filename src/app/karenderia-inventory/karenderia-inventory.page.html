<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/karenderia-dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Inventory Management</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" routerLink="/karenderia-dashboard">
        <ion-icon name="home"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="inventory-content">
  <!-- Summary Cards -->
  <div class="summary-grid">
    <div class="summary-card">
      <ion-icon name="cube-outline"></ion-icon>
      <div class="summary-content">
        <h3>Total Items</h3>
        <p class="value">{{ inventoryItems.length }}</p>
      </div>
    </div>
    <div class="summary-card warning">
      <ion-icon name="warning-outline"></ion-icon>
      <div class="summary-content">
        <h3>Low Stock Items</h3>
        <p class="value">{{ getLowStockItems().length }}</p>
      </div>
    </div>
    <div class="summary-card danger">
      <ion-icon name="time-outline"></ion-icon>
      <div class="summary-content">
        <h3>Expiring Soon</h3>
        <p class="value">{{ getExpiringItems().length }}</p>
      </div>
    </div>
    <div class="summary-card success">
      <ion-icon name="cash-outline"></ion-icon>
      <div class="summary-content">
        <h3>Total Value</h3>
        <p class="value">₱{{ getTotalInventoryValue().toLocaleString() }}</p>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filter-row">
      <ion-searchbar 
        [(ngModel)]="searchTerm"
        (ionInput)="filterItems()"
        placeholder="Search items or suppliers..."
        class="search-bar">
      </ion-searchbar>
      
      <ion-select 
        [(ngModel)]="selectedCategory"
        (ionChange)="filterItems()"
        placeholder="All Categories"
        interface="popover"
        class="category-filter">
        <ion-select-option value="all">All Categories</ion-select-option>
        <ion-select-option value="vegetables">Vegetables</ion-select-option>
        <ion-select-option value="meat">Meat</ion-select-option>
        <ion-select-option value="spices">Spices</ion-select-option>
        <ion-select-option value="beverages">Beverages</ion-select-option>
        <ion-select-option value="others">Others</ion-select-option>
      </ion-select>
    </div>
  </div>

  <!-- Inventory Grid -->
  <div class="inventory-grid">
    <ion-card class="inventory-item" *ngFor="let item of filteredItems">
      <div class="item-header">
        <h3>{{ item.name }}</h3>
        <ion-badge [color]="getStockStatus(item)">
          {{ item.currentStock }} {{ item.unit }}
        </ion-badge>
      </div>
      
      <ion-card-content>
        <div class="item-details">
          <p><strong>Supplier:</strong> {{ item.supplier }}</p>
          <p><strong>Cost per {{ item.unit }}:</strong> ₱{{ item.costPerUnit }}</p>
          <p><strong>Total Value:</strong> ₱{{ (item.currentStock * item.costPerUnit).toLocaleString() }}</p>
          <p><strong>Last Restocked:</strong> {{ item.lastRestocked | date:'MMM d, y' }}</p>
          <p *ngIf="item.expiryDate"><strong>Expires:</strong> {{ item.expiryDate | date:'MMM d, y' }}</p>
        </div>

        <div class="item-actions">
          <ion-button 
            fill="outline" 
            size="small" 
            color="primary"
            (click)="addStock(item)">
            <ion-icon name="add" slot="start"></ion-icon>
            Add Stock
          </ion-button>
          <ion-button 
            fill="outline" 
            size="small" 
            color="warning"
            (click)="removeStock(item)">
            <ion-icon name="remove" slot="start"></ion-icon>
            Use Stock
          </ion-button>
        </div>

        <!-- Warning indicators -->
        <div class="warnings">
          <ion-chip color="danger" *ngIf="item.currentStock <= item.minimumStock">
            <ion-icon name="warning"></ion-icon>
            <ion-label>Low Stock</ion-label>
          </ion-chip>
          <ion-chip color="warning" *ngIf="item.expiryDate && isExpiringSoon(item.expiryDate)">
            <ion-icon name="time"></ion-icon>
            <ion-label>Expiring Soon</ion-label>
          </ion-chip>
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="filteredItems.length === 0">
    <ion-icon name="cube-outline"></ion-icon>
    <h2>No items found</h2>
    <p>Try adjusting your search or filter criteria</p>
  </div>
</ion-content>
