<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      <div class="header-title">
        <ion-icon name="restaurant" color="primary"></ion-icon>
        <span>KaPlato</span>
      </div>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="goToProfile()" fill="clear">
        <ion-avatar slot="icon-only" class="profile-avatar">
          <ion-icon name="person-circle" color="medium"></ion-icon>
        </ion-avatar>
      </ion-button>
      <ion-button (click)="logout()" fill="clear" color="medium">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="tablet-view">
  <!-- Loading state -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading...</p>
  </div>

  <!-- Main content when user is authenticated -->
  <div *ngIf="!isLoading && currentUser" class="main-content">
    <!-- Welcome Section -->
    <div class="welcome-section">
      <ion-icon name="person-circle-outline" size="large" color="primary"></ion-icon>
      <h1>Welcome, {{ currentUser.displayName || 'User' }}!</h1>
      <p class="user-email">{{ currentUser.email }}</p>
    </div>

    <!-- Menu Section -->
    <div class="menu-section">
      <h2>Explore</h2>
      <div class="menu-grid">
        <ion-card button (click)="addTestData()" class="menu-card">
          <ion-card-content>
            <ion-icon name="add-circle-outline" size="large" color="success"></ion-icon>
            <h3>Add Test Karenderia</h3>
            <p>Generate sample karenderias</p>
          </ion-card-content>
        </ion-card>

        <ion-card button (click)="toggleMap()" class="menu-card">
          <ion-card-content>
            <ion-icon name="map-outline" size="large" color="primary"></ion-icon>
            <h3>Search Nearby Karenderia</h3>
            <p>Find karenderias near your location</p>
          </ion-card-content>
        </ion-card>

        <ion-card button (click)="openMealPlanner()" class="menu-card">
          <ion-card-content>
            <ion-icon name="restaurant-outline" size="large" color="secondary"></ion-icon>
            <h3>Meal Planner</h3>
            <p>Plan your meals efficiently</p>
          </ion-card-content>
        </ion-card>

        <ion-card button (click)="viewSuggestedKarenderias()" class="menu-card">
          <ion-card-content>
            <ion-icon name="star-outline" size="large" color="tertiary"></ion-icon>
            <h3>Suggested Karenderias</h3>
            <p>Explore recommended eateries</p>
          </ion-card-content>
        </ion-card>
      </div>
    </div>

    <!-- Meal Planner Section -->
    <div class="meal-planner-section">
      <h2>Meal Planner</h2>
      <p>Plan your meals for the week and stay organized.</p>
      <ion-button expand="block" (click)="openMealPlanner()" color="primary">
        <ion-icon name="calendar-outline" slot="start"></ion-icon>
        Open Meal Planner
      </ion-button>
    </div>

    <!-- Map Section -->
    <div *ngIf="showMap" class="map-section">
      <h2>Map View</h2>
      <div class="map-container">
        <app-map></app-map>
      </div>
    </div>
  </div>

  <!-- Not authenticated -->
  <div *ngIf="!isLoading && !currentUser" class="loading-container">
    <p>Not authenticated. Redirecting...</p>
  </div>
</ion-content>
