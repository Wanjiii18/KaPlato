<ion-content class="pos-content">
  <!-- Mobile Top Bar (visible only on mobile) -->
  <div class="mobile-top-bar">
    <div class="mobile-brand" routerLink="/karenderia-settings">
      <div class="brand-icon">{{getKarenderiaBrandInitials()}}</div>
      <div class="brand-info">
        <h3>{{getKarenderiaDisplayName()}}</h3>
        <span>POS System</span>
      </div>
    </div>
    <div class="mobile-actions">
      <ion-button fill="clear" size="small" routerLink="/karenderia-settings">
        <ion-icon name="person-circle-outline" slot="icon-only"></ion-icon>
      </ion-button>
      <ion-button fill="clear" size="small" (click)="logout()">
        <ion-icon name="log-out-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </div>
  </div>

  <div class="pos-layout">
    <!-- Left Sidebar Navigation -->
    <div class="pos-sidebar">
      <div class="sidebar-header">
        <div class="brand">
          <div class="brand-icon">{{getKarenderiaBrandInitials()}}</div>
          <div class="brand-info">
            <h3>{{getKarenderiaDisplayName()}}</h3>
            <span>Kitchen</span>
          </div>
        </div>
      </div>

      <nav class="sidebar-nav">
        <a class="nav-item" routerLink="/karenderia-dashboard">
          <ion-icon name="grid-outline"></ion-icon>
          <span>Dashboard</span>
        </a>
        <a class="nav-item" routerLink="/karenderia-menu">
          <ion-icon name="restaurant-outline"></ion-icon>
          <span>Menu Management</span>
        </a>
        <a class="nav-item active">
          <ion-icon name="calculator-outline"></ion-icon>
          <span>POS System</span>
        </a>
        <a class="nav-item" routerLink="/karenderia-orders">
          <ion-icon name="receipt-outline"></ion-icon>
          <span>Orders</span>
        </a>
        <a class="nav-item desktop-only" routerLink="/karenderia-settings">
          <ion-icon name="person-outline"></ion-icon>
          <span>Profile</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <a class="nav-item" (click)="logout()">
          <ion-icon name="log-out-outline"></ion-icon>
          <span>Sign Out</span>
        </a>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="pos-main">
      <!-- Header -->
      <div class="pos-header">
        <h1>Point of Sale</h1>
      </div>

      <!-- POS Content -->
      <div class="pos-content-area">
        <!-- Left Side - Menu -->
        <div class="menu-section">
          <!-- Search Bar -->
          <div class="search-section">
            <div class="search-input">
              <ion-icon name="search-outline"></ion-icon>
              <input type="text" placeholder="Search menu items..." [(ngModel)]="searchTerm">
            </div>
          </div>

          <!-- Category Filters -->
          <div class="category-filters">
            <button 
              *ngFor="let category of categories"
              class="category-btn" 
              [class.active]="selectedCategory === category.id"
              (click)="selectCategory(category.id)">
              <ion-icon [name]="category.icon"></ion-icon>
              {{ category.name }}
            </button>
          </div>

          <!-- Menu Items Grid -->
          <div class="menu-grid">
            <!-- Loading State -->
            <div *ngIf="isLoadingMenu" class="loading-message">
              <ion-spinner name="bubbles"></ion-spinner>
              <p>Loading menu items...</p>
            </div>
            
            <!-- No Items Message -->
            <div *ngIf="!isLoadingMenu && getFilteredMenuItems().length === 0" class="no-items-message">
              <ion-icon name="restaurant-outline"></ion-icon>
              <p>No menu items available</p>
              <span>Try selecting a different category</span>
            </div>
            
            <!-- Menu Items -->
            <div 
              *ngFor="let item of getFilteredMenuItems()" 
              class="menu-item-card"
              (click)="addToOrder(item)">
              <div class="item-image">
                <img [src]="getItemImage(item)" [alt]="item.name" (error)="handleImageError($event)">
              </div>
              <div class="item-info">
                <h4>{{ item.name }}</h4>
                <p class="price">₱{{ item.price }}</p>
                <span class="category">{{ item.category }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Side - Current Order -->
        <div class="order-section">
          <div class="order-header">
            <h2>Current Order</h2>
          </div>

          <!-- Table Number -->
          <div class="table-section">
            <label>Table Number</label>
            <input 
              type="text" 
              placeholder="Enter table number" 
              [(ngModel)]="tableNumber"
              class="table-input">
          </div>

          <!-- Order Items -->
          <div class="order-items">
            <div *ngIf="currentOrder.length === 0" class="empty-order">
              <p>No items in order</p>
              <span>Select items from the menu to add them</span>
            </div>
            
            <div *ngFor="let item of currentOrder" class="order-item">
              <div class="item-image-small">
                <img [src]="getItemImage(item)" [alt]="item.name">
              </div>
              <div class="item-details">
                <h4>{{ item.name }}</h4>
                <p>₱{{ item.price }}</p>
              </div>
              <div class="quantity-controls">
                <button (click)="decreaseQuantity(item)">
                  <ion-icon name="remove"></ion-icon>
                </button>
                <span>{{ item.quantity }}</span>
                <button (click)="increaseQuantity(item)">
                  <ion-icon name="add"></ion-icon>
                </button>
                <button class="remove-btn" (click)="removeFromOrder(item)">
                  <ion-icon name="trash-outline"></ion-icon>
                </button>
              </div>
            </div>
          </div>

          <!-- Order Summary -->
          <div class="order-summary" *ngIf="currentOrder.length > 0">
            <div class="summary-line">
              <span>Subtotal:</span>
              <span>₱{{ getSubtotal().toFixed(2) }}</span>
            </div>
            <div class="summary-line">
              <span>VAT (12%):</span>
              <span>₱{{ getVAT().toFixed(2) }}</span>
            </div>
            <div class="summary-total">
              <span>Total:</span>
              <span>₱{{ getTotal().toFixed(2) }}</span>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="order-actions" *ngIf="currentOrder.length > 0">
            <button class="clear-btn" (click)="clearOrder()">Clear</button>
            <button class="pay-btn" (click)="processPayment()" [disabled]="!tableNumber">
              <ion-icon name="card-outline"></ion-icon>
              Pay
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-content>


